<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Underscore.js: Iteration Utilities</title>
  </head>

  <body>

    <p>Iteration Utilities</p>

    <script src="js/underscore-min.js"></script>
    <script>

      // nationa_league is an array of objects

      var national_league = [
        {
          name: "Arizona Diamondbacks",
          wins: 81,
          losses: 81,
          division: "west"
        },
        {
          name: "Atlanta Braves",
          wins: 94,
          losses: 68,
          division: "east"
        },
        {
          name: "Chicago Cubs",
          wins: 61,
          losses: 101,
          division: "central"
        },
        {
          name: "Cincinnati Reds",
          wins: 97,
          losses: 65,
          division: "central"
        },
        {
          name: "Colorado Rockies",
          wins: 64,
          losses: 98,
          division: "west"
        },
        {
          name: "Houston Astros",
          wins: 55,
          losses: 107,
          division: "central"
        },
        {
          name: "Los Angeles Dodgers",
          wins: 86,
          losses: 76,
          division: "west"
        },
        {
          name: "Miami Marlins",
          wins: 69,
          losses: 93,
          division: "east"
        },
        {
          name: "Milwaukee Brewers",
          wins: 83,
          losses: 79,
          division: "central"
        },
        {
          name: "New York Mets",
          wins: 74,
          losses: 88,
          division: "east"
        },
        {
          name: "Philadelphia Phillies",
          wins: 81,
          losses: 81,
          division: "east"
        },
        {
          name: "Pittsburgh Pirates",
          wins: 79,
          losses: 83,
          division: "central"
        },
        {
          name: "San Diego Padres",
          wins: 76,
          losses: 86,
          division: "west"
        },
        {
          name: "San Francisco Giants",
          wins: 94,
          losses: 68,
          division: "west"
        },
        {
          name: "St. Louis Cardinals",
          wins: 88,
          losses: 74,
          division: "central"
        },
        {
          name: "Washington Nationals",
          wins: 98,
          losses: 64,
          division: "east"
        }
      ];


      _(national_league).each(
        function(team) { console.log(team.name) }
      );

      // .each() executes a function on every element in a collection
      // it is a functional replacement for a traditional 'for' loop

      // when used with arrays, underscore passes the element, index
      // and list; when used with objects, underscore passes the values
      // keys and list.


      var win_pct = _(national_league).map(
        function(team) {
          return Math.round(100 * team.wins / (team.wins + team.losses));
        }
      );

      // .map() iterates through a collection and transforms each
      // element with a function and returns a new collection; in the
      // above example, the function returns team winning percentages


      var teams_above_500 = _(national_league).reduce(
        function(count, team) {
          return count + (team.wins > team.losses)
        }, 0 // starting point for reduce value
      );

      // .reduce() iterates through a collection and returns a single
      // value; the first argument initializes the value, the other
      // feeds the function to update the first argument's value;
      // in the above example, the function counts the number of teams
      // with a win percentage above .500

    </script>
  </body>
</html>
